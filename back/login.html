<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>管理员登录</title>
    <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    <style>
        body { background-color: #f5f5f5; }
        .login-panel { margin-top: 100px; padding: 30px; background: #fff; border-radius: 5px; box-shadow: 0 0 15px #ccc; }
        #canvasAdmin { cursor: pointer; border: 1px solid #ccc; width: 100%; height: 34px;}
    </style>
</head>
<body>

<div class="container">
    <div class="row">
        <div class="col-md-4 col-md-offset-4 login-panel">
            <h2 class="text-center text-primary">后台管理系统</h2>
            <br>
            <form id="adminForm">
                <div class="form-group">
                    <label>管理员账号</label>
                    <input type="text" class="form-control" id="adminName" placeholder="admin" required>
                </div>
                <div class="form-group">
                    <label>密码</label>
                    <input type="password" class="form-control" placeholder="任意密码" required>
                </div>
                <div class="form-group">
                    <label>验证码</label>
                    <div class="row">
                        <div class="col-xs-7">
                            <input type="text" class="form-control" id="inputCode" required>
                        </div>
                        <div class="col-xs-5">
                            <canvas id="canvasAdmin" width="100" height="34"></canvas>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary btn-block" type="submit">登 录</button>
            </form>
            <hr>
            <div class="text-center">
                <a href="../front/bookList.html">返回前台首页</a>
            </div>
        </div>
    </div>
</div>

<script src="../script/jquery-3.7.1.min.js"></script>
<script src="../bootstrap/js/bootstrap.min.js"></script>
<script>
    var code = "";
    function draw() {
        var ctx = document.getElementById("canvasAdmin").getContext("2d");
        ctx.clearRect(0,0,100,34);
        ctx.fillStyle = "#eee"; ctx.fillRect(0,0,100,34);
        ctx.font="20px Arial"; ctx.fillStyle="blue";
        code = Math.floor(Math.random()*9000+1000).toString(); // 简单的4位数字
        ctx.fillText(code, 25, 25);
    }
    
    $(function(){
        draw();
        $("#canvasAdmin").click(draw);
        
        $("#adminForm").submit(function(e){
            e.preventDefault();
            if($("#inputCode").val() != code) {
                alert("验证码错误");
                draw();
                return;
            }
            sessionStorage.setItem("currentAdmin", $("#adminName").val());
            window.location.href = "bookList.html";
        });
    });
</script>
</body>
</html>